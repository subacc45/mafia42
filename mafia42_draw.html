<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>마피아42 카드 뽑기</title>
<style>
body{background:#0f172a;color:#e6eef8;font-family:Inter,Roboto,Apple SD Gothic Neo,맑은고딕,sans-serif;margin:0;padding:30px}
.wrap{max-width:640px;margin:auto;text-align:center}
select,input,button{padding:8px 10px;border:none;border-radius:8px;font-size:15px}
select,input{background:#1e293b;color:#e6eef8}
button{background:#7c3aed;color:white;cursor:pointer}
table{width:100%;border-collapse:collapse;margin-top:20px}
th,td{padding:8px;border-bottom:1px solid rgba(255,255,255,0.1);text-align:left}
</style>
</head>
<body>
<div class="wrap">
  <h2>마피아42 카드 뽑기</h2>
  <div>
    <select id="mode">
      <option value="advanced">고급 카드팩 (10장)</option>
      <option value="4">4티어</option>
      <option value="5">5티어</option>
      <option value="6">6티어</option>
    </select>
    <input id="count" type="number" min="1" max="500" value="10">
    <button id="draw">뽑기</button>
  </div>
  <div id="result"></div>
</div>

<script>
const CATEGORIES=["마피아","마피아 팀 보조","경찰 계열","의사","시민 팀 특수","교주"];
const WEIGHTS=[3,1,1,1,5,1];
const mafia_support=["스파이","짐승인간","마담","도둑","마녀","과학자","사기꾼","청부업자"];
const police=["경찰","자경단원","요원"];
const citizen_special=["군인","정치인","영매","연인","기자","건달","사립탐정","도굴꾼","테러리스트","성직자","예언자","판사","간호사","마술사","해커","심리학자","용병","공무원","파파라치","비밀결사","최면술사","점쟁이"];

function weightedChoice(items,w){
  let t=w.reduce((a,b)=>a+b,0),r=Math.random()*t;
  for(let i=0;i<items.length;i++){r-=w[i];if(r<0)return items[i];}
  return items[items.length-1];
}
function pickRole(cat){
  if(cat==="마피아")return "마피아";
  if(cat==="마피아 팀 보조")return mafia_support[Math.random()*mafia_support.length|0];
  if(cat==="경찰 계열")return police[Math.random()*police.length|0];
  if(cat==="의사")return "의사";
  if(cat==="시민 팀 특수")return citizen_special[Math.random()*citizen_special.length|0];
  return "교주";
}
function pickTier(){
  const r=Math.random()*100;
  if(r<89.1)return 3;
  if(r<99)return 4;
  return 5;
}
function drawAdvanced(){
  let cards=[];for(let i=0;i<10;i++){cards.push({tier:pickTier(),role:pickRole(weightedChoice(CATEGORIES,WEIGHTS))});}
  if(cards.every(c=>c.tier===3)){cards[Math.random()*10|0].tier=4;}
  return cards;
}
function drawFixed(tier,n){
  let arr=[];for(let i=0;i<n;i++){arr.push({tier,role:pickRole(weightedChoice(CATEGORIES,WEIGHTS))});}
  return arr;
}

document.getElementById("draw").onclick=()=>{
  const m=document.getElementById("mode").value;
  const n=parseInt(document.getElementById("count").value)||10;
  let result=[];
  if(m==="advanced")result=drawAdvanced();else result=drawFixed(parseInt(m),n);
  let html="<table><tr><th>#</th><th>티어</th><th>직업</th></tr>";
  result.forEach((c,i)=>{html+=`<tr><td>${i+1}</td><td>${c.tier}</td><td>${c.role}</td></tr>`});
  html+="</table>";
  document.getElementById("result").innerHTML=html;
};
</script>
</body>
</html>
